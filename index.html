<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WeatherApp</title>
    <link
      rel="icon"
      href="WeatherAppUsingJavaScript/images/rain.png"
      type="image/x-icon"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(
          135deg,
          #0c0c0c 0%,
          #1a1a2e 25%,
          #16213e 50%,
          #1a1a2e 75%,
          #0c0c0c 100%
        );
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        position: relative;
        overflow: hidden;
        transition: background 0.5s ease;
      }

      /* Animated background particles */
      body::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: radial-gradient(
            2px 2px at 20px 30px,
            #ffffff20,
            transparent
          ),
          radial-gradient(2px 2px at 40px 70px, #ffffff15, transparent),
          radial-gradient(1px 1px at 90px 40px, #ffffff25, transparent),
          radial-gradient(1px 1px at 130px 80px, #ffffff20, transparent),
          radial-gradient(2px 2px at 160px 30px, #ffffff15, transparent);
        background-repeat: repeat;
        background-size: 200px 100px;
        animation: sparkle 20s linear infinite;
        pointer-events: none;
      }

      @keyframes sparkle {
        0% {
          transform: translateY(0px);
        }
        100% {
          transform: translateY(-200px);
        }
      }

      .card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 30px;
        padding: 30px;
        width: 100%;
        max-width: 450px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3),
          0 0 100px rgba(255, 255, 255, 0.05);
        position: relative;
        overflow: hidden;
        animation: cardFloat 6s ease-in-out infinite;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      @keyframes cardFloat {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(
          45deg,
          transparent,
          rgba(255, 255, 255, 0.03),
          transparent
        );
        animation: shimmer 3s infinite;
        pointer-events: none;
      }

      @keyframes shimmer {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .header-buttons {
        position: absolute;
        top: 15px;
        width: calc(100% - 60px);
        display: flex;
        justify-content: space-between;
        z-index: 10;
      }

      .theme-toggle,
      .location-btn {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        border-radius: 15px;
        padding: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .theme-toggle:hover,
      .location-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.05);
      }

      .theme-toggle svg,
      .location-btn svg {
        width: 20px;
        height: 20px;
        fill: white;
      }

      .search {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin: 50px 0 30px;
        position: relative;
      }

      .search input {
        border: none;
        outline: none;
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        padding: 15px 20px;
        height: 50px;
        border-radius: 50px;
        flex: 1;
        margin-right: 10px;
        font-size: 16px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
      }

      .search input:focus {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .search input::placeholder {
        color: rgba(255, 255, 255, 0.6);
      }

      .search button {
        border: none;
        outline: none;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 50%;
        width: 50px;
        height: 50px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      .search button:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.6);
      }

      .search button:active {
        transform: translateY(0px) scale(0.95);
      }

      .search button svg {
        width: 18px;
        height: 18px;
        fill: white;
      }

      .weather {
        width: 100%;
        text-align: center;
        position: relative;
        display: none;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.5s ease-out, transform 0.5s ease-out;
      }

      .weather.active {
        display: block;
        opacity: 1;
        transform: translateY(0);
      }

      .weather-icon {
        width: 120px;
        height: 120px;
        margin: 15px auto;
        display: block;
        filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.3));
        animation: iconBounce 2s ease-in-out infinite;
      }

      @keyframes iconBounce {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .temp {
        font-size: 3.5rem;
        font-weight: 300;
        color: #fff;
        margin: 15px 0;
        text-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        animation: tempGlow 3s ease-in-out infinite;
      }

      @keyframes tempGlow {
        0%,
        100% {
          text-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }
        50% {
          text-shadow: 0 5px 30px rgba(255, 255, 255, 0.2);
        }
      }

      .city {
        font-size: 1.8rem;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 30px;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      }

      .details {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-top: 20px;
      }

      .col {
        display: flex;
        align-items: center;
        text-align: left;
        background: rgba(255, 255, 255, 0.05);
        padding: 15px;
        border-radius: 15px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
      }

      .col:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      .col img,
      .col svg {
        width: 35px;
        height: 35px;
        margin-right: 12px;
        filter: brightness(0) invert(1);
        opacity: 0.8;
      }

      .col div p:first-child {
        font-size: 1.5rem;
        font-weight: 600;
        color: #fff;
        margin-bottom: 5px;
      }

      .col div p:last-child {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.6);
        font-weight: 400;
      }

      /* Loading animation */
      .loading {
        display: none;
        width: 40px;
        height: 40px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-top: 3px solid #fff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 20px auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Weather not found */
      .weather-not-found {
        display: none;
        color: rgba(255, 255, 255, 0.8);
        margin-top: 20px;
        font-size: 1rem;
        text-align: center;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.5s ease-out, transform 0.5s ease-out;
      }

      .weather-not-found.active {
        display: block;
        opacity: 1;
        transform: translateY(0);
      }

      /* Forecast section */
      .forecast {
        margin-top: 25px;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        display: none;
      }

      .forecast-title {
        color: rgba(255, 255, 255, 0.8);
        font-size: 1.1rem;
        margin-bottom: 15px;
        text-align: center;
      }

      .forecast-days {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }

      .forecast-day {
        text-align: center;
        padding: 12px 8px;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.3s ease;
      }

      .forecast-day:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateY(-3px);
      }

      .forecast-day .day {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.8rem;
        margin-bottom: 5px;
      }

      .forecast-day .forecast-icon {
        width: 25px;
        height: 25px;
        margin: 5px auto;
      }

      .forecast-day .forecast-temp {
        color: #fff;
        font-size: 0.9rem;
        font-weight: 600;
      }

      /* Additional info section */
      .additional-info {
        margin-top: 20px;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        display: none;
      }

      .info-item {
        background: rgba(255, 255, 255, 0.05);
        padding: 12px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        text-align: center;
        transition: all 0.3s ease;
      }

      .info-item:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateY(-2px);
      }

      .info-item .info-label {
        color: rgba(255, 255, 255, 0.6);
        font-size: 0.8rem;
        margin-bottom: 5px;
      }

      .info-item .info-value {
        color: #fff;
        font-size: 1.1rem;
        font-weight: 600;
      }

      /* Toast notification */
      .toast {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 12px 20px;
        border-radius: 10px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
        z-index: 1000;
        max-width: 90%;
        text-align: center;
      }

      .toast.show {
        transform: translateX(-50%) translateY(0);
      }

      .toast.success {
        border-left: 4px solid #4caf50;
      }

      .toast.error {
        border-left: 4px solid #f44336;
      }

      /* Light theme */
      body.light-theme {
        background: linear-gradient(
          135deg,
          #74b9ff 0%,
          #0984e3 25%,
          #74b9ff 50%,
          #0984e3 75%,
          #74b9ff 100%
        );
      }

      body.light-theme .card {
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1);
      }

      body.light-theme .temp,
      body.light-theme .city,
      body.light-theme .col div p:first-child,
      body.light-theme .info-value,
      body.light-theme .forecast-temp {
        color: #2c3e50;
      }

      body.light-theme .search input {
        background: rgba(0, 0, 0, 0.05);
        color: #2c3e50;
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      body.light-theme .search input::placeholder {
        color: rgba(0, 0, 0, 0.5);
      }

      body.light-theme .col div p:last-child,
      body.light-theme .info-label,
      body.light-theme .forecast-day .day,
      body.light-theme .forecast-title {
        color: rgba(0, 0, 0, 0.6);
      }

      body.light-theme .search button {
        background: linear-gradient(135deg, #0984e3 0%, #4a69bd 100%);
        box-shadow: 0 5px 20px rgba(9, 132, 227, 0.4);
      }

      body.light-theme .search button:hover {
        box-shadow: 0 10px 30px rgba(9, 132, 227, 0.6);
      }

      body.light-theme .search button svg,
      body.light-theme .location-btn svg,
      body.light-theme .theme-toggle svg {
        fill: white;
      }

      body.light-theme .col,
      body.light-theme .forecast,
      body.light-theme .forecast-day,
      body.light-theme .info-item {
        background: rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      body.light-theme .col:hover,
      body.light-theme .forecast-day:hover,
      body.light-theme .info-item:hover {
        background: rgba(0, 0, 0, 0.08);
      }

      /* Responsive design */
      @media (min-width: 768px) {
        .card {
          padding: 40px;
        }

        .search {
          margin: 60px 0 40px;
        }

        .search input {
          padding: 18px 25px;
          height: 60px;
          font-size: 18px;
          margin-right: 16px;
        }

        .search button {
          width: 60px;
          height: 60px;
        }

        .search button svg {
          width: 20px;
          height: 20px;
        }

        .weather-icon {
          width: 150px;
          height: 150px;
          margin: 20px auto;
        }

        .temp {
          font-size: 5rem;
          margin: 20px 0;
        }

        .city {
          font-size: 2.2rem;
          margin-bottom: 40px;
        }

        .details {
          flex-direction: row;
          gap: 0;
          margin-top: 30px;
        }

        .col {
          padding: 20px;
          border-radius: 20px;
          margin: 0 10px;
        }

        .col img,
        .col svg {
          width: 40px;
          height: 40px;
          margin-right: 15px;
        }

        .col div p:first-child {
          font-size: 1.8rem;
        }

        .col div p:last-child {
          font-size: 1rem;
        }

        .forecast {
          padding: 20px;
          margin-top: 30px;
        }

        .forecast-title {
          font-size: 1.2rem;
          margin-bottom: 20px;
        }

        .forecast-days {
          grid-template-columns: repeat(5, 1fr);
          gap: 15px;
        }

        .forecast-day {
          padding: 15px 10px;
          border-radius: 15px;
        }

        .forecast-day .day {
          font-size: 0.9rem;
          margin-bottom: 8px;
        }

        .forecast-day .forecast-icon {
          width: 30px;
          height: 30px;
          margin: 8px auto;
        }

        .forecast-day .forecast-temp {
          font-size: 1.1rem;
        }

        .additional-info {
          grid-template-columns: repeat(4, 1fr);
          gap: 15px;
          margin-top: 25px;
        }

        .info-item {
          padding: 15px;
          border-radius: 15px;
        }

        .info-item .info-label {
          font-size: 0.9rem;
        }

        .info-item .info-value {
          font-size: 1.3rem;
        }

        .toast {
          top: 20px;
          bottom: auto;
          left: auto;
          right: 20px;
          transform: translateX(400px);
        }

        .toast.show {
          transform: translateX(0);
        }
      }

      @media (min-width: 992px) {
        .additional-info {
          grid-template-columns: repeat(5, 1fr);
        }
      }
    </style>
  </head>
  <body>
    <div class="card">
      <div class="search">
        <input type="text" placeholder="Enter city name" spellcheck="false" />
        <button onclick="searchWeather()">
          <svg viewBox="0 0 24 24">
            <path
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
        </button>
      </div>

      <div class="loading"></div>

      <div class="weather">
        <img
          src="WeatherAppUsingJavaScript/images/rain.png"
          class="weather-icon"
          alt="Weather Icon"
        />

        <h1 class="temp">28°C</h1>
        <h2 class="city">New York</h2>

        <div class="details">
          <div class="col">
            <img src="images/humidity.png" alt="Humidity Icon" />
            <div>
              <p class="humidity">50%</p>
              <p>Humidity</p>
            </div>
          </div>
          <div class="col">
            <img src="images/wind.png" alt="Wind Icon" />
            <div>
              <p class="wind">15 km/h</p>
              <p>Wind Speed</p>
            </div>
          </div>
        </div>

        <div class="forecast">
          <h3 class="forecast-title">5-Day Forecast</h3>
          <div class="forecast-days"></div>
        </div>

        <div class="additional-info">
          <div class="info-item">
            <p class="info-label">Feels Like</p>
            <p class="info-value" id="feels-like">--°C</p>
          </div>
          <div class="info-item">
            <p class="info-label">Pressure</p>
            <p class="info-value" id="pressure">-- hPa</p>
          </div>
          <div class="info-item">
            <p class="info-label">Visibility</p>
            <p class="info-value" id="visibility">-- km</p>
          </div>
          <div class="info-item">
            <p class="info-label">Sunrise</p>
            <p class="info-value" id="sunrise">--:-- AM</p>
          </div>
          <div class="info-item">
            <p class="info-label">Sunset</p>
            <p class="info-value" id="sunset">--:-- PM</p>
          </div>
        </div>
      </div>

      <div class="weather-not-found">
        <p>Kota tidak ditemukan atau terjadi kesalahan.</p>
        <p>Mohon coba lagi dengan nama kota yang valid.</p>
      </div>

      <div id="toastNotification" class="toast"></div>
    </div>

    <script>
      const apiKey = "5ae39ec8e827591b58c72c90a8040976";
      const apiUrl =
        "https://api.openweathermap.org/data/2.5/weather?units=metric&";
      const forecastApiUrl =
        "https://api.openweathermap.org/data/2.5/forecast?units=metric&";

      const searchBox = document.querySelector(".search input");
      const searchBtn = document.querySelector(".search button");
      const weatherIcon = document.querySelector(".weather-icon");
      const loadingSpinner = document.querySelector(".loading");
      const weatherDisplay = document.querySelector(".weather");
      const weatherNotFound = document.querySelector(".weather-not-found");
      const toastNotification = document.getElementById("toastNotification");
      const forecastSection = document.querySelector(".forecast");
      const forecastDaysContainer = document.querySelector(".forecast-days");
      const additionalInfoSection = document.querySelector(".additional-info");

      // Fungsi untuk menampilkan toast notification
      function showToast(message, type = "info") {
        toastNotification.textContent = message;
        toastNotification.className = `toast show ${type}`;
        setTimeout(() => {
          toastNotification.classList.remove("show");
        }, 3000);
      }

      // Fungsi untuk memperbarui icon cuaca
      function updateWeatherIcon(weatherCondition) {
        let iconSrc = "images/";
        switch (weatherCondition) {
          case "Clear":
            iconSrc += "clear.png";
            break;
          case "Clouds":
            iconSrc += "clouds.png";
            break;
          case "Rain":
            iconSrc += "rain.png";
            break;
          case "Drizzle":
            iconSrc += "drizzle.png";
            break;
          case "Mist":
          case "Fog":
          case "Haze":
            iconSrc += "mist.png";
            break;
          case "Snow":
            iconSrc += "snow.png";
            break;
          case "Thunderstorm":
            iconSrc += "thunderstorm.png";
            break;
          default:
            iconSrc += "clear.png";
        }
        weatherIcon.src = iconSrc;
      }

      // Fungsi untuk memperbarui UI cuaca
      function updateWeatherUI(data) {
        document.querySelector(".city").innerHTML = data.name;
        document.querySelector(".temp").innerHTML =
          Math.round(data.main.temp) + "°c";
        document.querySelector(".humidity").innerHTML =
          data.main.humidity + "%";
        document.querySelector(".wind").innerHTML =
          Math.round(data.wind.speed * 3.6) + " km/h";

        // Update additional info
        document.getElementById("feels-like").innerHTML =
          Math.round(data.main.feels_like) + "°C";
        document.getElementById("pressure").innerHTML =
          data.main.pressure + " hPa";
        document.getElementById("visibility").innerHTML =
          (data.visibility / 1000).toFixed(1) + " km";

        const sunriseTime = new Date(
          data.sys.sunrise * 1000
        ).toLocaleTimeString("id-ID", {
          hour: "2-digit",
          minute: "2-digit",
          hour12: true,
        });
        const sunsetTime = new Date(data.sys.sunset * 1000).toLocaleTimeString(
          "id-ID",
          {
            hour: "2-digit",
            minute: "2-digit",
            hour12: true,
          }
        );
        document.getElementById("sunrise").innerHTML = sunriseTime;
        document.getElementById("sunset").innerHTML = sunsetTime;

        updateWeatherIcon(data.weather[0].main);

        // Tampilkan bagian cuaca dan info tambahan
        weatherDisplay.classList.add("active");
        additionalInfoSection.style.display = "grid";
        weatherNotFound.classList.remove("active");
      }

      // Fungsi untuk mengambil prakiraan 5 hari
      async function getForecast(city) {
        try {
          const response = await fetch(
            forecastApiUrl + `q=${city}&appid=${apiKey}`
          );
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json();
          displayForecast(data);
        } catch (error) {
          console.error("Gagal mengambil prakiraan cuaca:", error);
        }
      }

      // Fungsi untuk menampilkan prakiraan 5 hari
      function displayForecast(data) {
        forecastDaysContainer.innerHTML = "";
        const dailyData = {};

        // Filter data untuk mendapatkan satu entri per hari (sekitar tengah hari)
        data.list.forEach((item) => {
          const date = new Date(item.dt * 1000);
          const day = date.toLocaleDateString("en-US", { weekday: "short" });
          const hour = date.getHours();

          if (
            !dailyData[day] ||
            Math.abs(hour - 12) <
              Math.abs(new Date(dailyData[day].dt * 1000).getHours() - 12)
          ) {
            dailyData[day] = item;
          }
        });

        // Tampilkan hanya 5 hari ke depan
        const daysToShow = Object.keys(dailyData).slice(0, 5);

        daysToShow.forEach((dayName) => {
          const dayData = dailyData[dayName];
          const temp = Math.round(dayData.main.temp);
          const iconCode = dayData.weather[0].icon;
          const iconUrl = `https://openweathermap.org/img/wn/${iconCode}.png`;

          const forecastDayDiv = document.createElement("div");
          forecastDayDiv.className = "forecast-day";
          forecastDayDiv.innerHTML = `
            <p class="day">${dayName}</p>
            <img src="${iconUrl}" class="forecast-icon" alt="Forecast Icon">
            <p class="forecast-temp">${temp}°</p>
          `;
          forecastDaysContainer.appendChild(forecastDayDiv);
        });
        forecastSection.style.display = "block";
      }

      // Fungsi utama untuk memeriksa cuaca
      async function checkWeather(city) {
        weatherDisplay.classList.remove("active");
        additionalInfoSection.style.display = "none";
        forecastSection.style.display = "none";
        weatherNotFound.classList.remove("active");
        loadingSpinner.style.display = "block";

        try {
          const response = await fetch(apiUrl + `q=${city}&appid=${apiKey}`);

          if (!response.ok) {
            loadingSpinner.style.display = "none";
            if (response.status === 404) {
              weatherNotFound.classList.add("active");
              showToast(
                "Kota tidak ditemukan. Mohon cek kembali nama kota.",
                "error"
              );
            } else {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return;
          }

          const data = await response.json();
          console.log(data);

          updateWeatherUI(data);
          getForecast(city);
        } catch (error) {
          loadingSpinner.style.display = "none";
          console.error("Ada masalah saat mengambil data cuaca:", error);
          weatherNotFound.classList.add("active");
          showToast("Gagal mengambil data cuaca. Coba lagi nanti.", "error");
        } finally {
          loadingSpinner.style.display = "none";
        }
      }

      // Event listener untuk tombol search
      function searchWeather() {
        const city = searchBox.value.trim();
        if (city) {
          checkWeather(city);
        } else {
          showToast("Silakan masukkan nama kota.", "error");
        }
      }

      // Event listener untuk Enter key pada input search
      searchBox.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          searchWeather();
        }
      });

      // Fungsi untuk mendapatkan lokasi saat ini
      function getCurrentLocation() {
        if (navigator.geolocation) {
          loadingSpinner.style.display = "block";
          weatherDisplay.classList.remove("active");
          additionalInfoSection.style.display = "none";
          forecastSection.style.display = "none";
          weatherNotFound.classList.remove("active");

          navigator.geolocation.getCurrentPosition(
            async (position) => {
              const lat = position.coords.latitude;
              const lon = position.coords.longitude;

              try {
                const geoApiUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;
                const response = await fetch(geoApiUrl);
                if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                checkWeather(data.name);
                showToast(`Cuaca di lokasi Anda: ${data.name}`, "success");
              } catch (error) {
                console.error(
                  "Gagal mendapatkan nama kota dari koordinat:",
                  error
                );
                showToast(
                  "Gagal mendeteksi lokasi atau mengambil data cuaca.",
                  "error"
                );
                loadingSpinner.style.display = "none";
                weatherNotFound.classList.add("active");
              }
            },
            (error) => {
              loadingSpinner.style.display = "none";
              console.error("Error getting geolocation:", error);
              showToast(
                "Gagal mendapatkan lokasi Anda. Pastikan layanan lokasi diaktifkan.",
                "error"
              );
              weatherNotFound.classList.add("active");
            }
          );
        } else {
          showToast("Geolocation tidak didukung oleh browser Anda.", "error");
        }
      }

      // Fungsi untuk toggle tema
      function toggleTheme() {
        document.body.classList.toggle("light-theme");
        if (document.body.classList.contains("light-theme")) {
          localStorage.setItem("theme", "light");
        } else {
          localStorage.setItem("theme", "dark");
        }
      }

      // Load theme preference on page load
      document.addEventListener("DOMContentLoaded", () => {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme === "light") {
          document.body.classList.add("light-theme");
        } else {
          document.body.classList.remove("light-theme");
        }
        checkWeather("Indramayu");
      });

      // Mousemove effect for card
      document.addEventListener("mousemove", (e) => {
        const card = document.querySelector(".card");
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        card.style.setProperty("--mouse-x", `${x}px`);
        card.style.setProperty("--mouse-y", `${y}px`);
      });
    </script>
  </body>
</html>
